// JSON Data ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
const quizData = {
    "title": "Quiz Master - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ",
    "questions": [
        {
            "id": 1,
            "question": "‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏î?",
            "options": ["‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£", "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà", "‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô", "‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà"],
            "correct": 0,
            "explanation": "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢",
            "details": [
                "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£: ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á",
                "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà: ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ ‡∏°‡∏µ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏•‡πâ‡∏≤‡∏ô‡∏ô‡∏≤",
                "‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô: ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠",
                "‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà: ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ"
            ]
        },
        {
            "id": 2,
            "question": "‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå H ‡∏Ñ‡∏∑‡∏≠?",
            "options": ["‡∏Æ‡∏µ‡πÄ‡∏•‡∏µ‡∏¢‡∏°", "‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÄ‡∏à‡∏ô", "‡∏Æ‡∏≤‡πÇ‡∏•‡πÄ‡∏à‡∏ô", "‡πÑ‡∏Æ‡∏î‡∏£‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå"],
            "correct": 1,
            "explanation": "H ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÄ‡∏à‡∏ô",
            "details": [
                "‡∏Æ‡∏µ‡πÄ‡∏•‡∏µ‡∏¢‡∏°: He ‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏â‡∏∑‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏´‡∏°‡∏π‡πà 18",
                "‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÄ‡∏à‡∏ô: H ‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏ö‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏ß‡∏≤‡∏•",
                "‡∏Æ‡∏≤‡πÇ‡∏•‡πÄ‡∏à‡∏ô: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏≤‡∏ï‡∏∏‡∏´‡∏°‡∏π‡πà 17 ‡πÄ‡∏ä‡πà‡∏ô F, Cl, Br, I",
                "‡πÑ‡∏Æ‡∏î‡∏£‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå: ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ò‡∏≤‡∏ï‡∏∏ ‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà OH- ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏°‡∏µ"
            ]
        },
        {
            "id": 3,
            "question": "‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ô‡∏ß‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á '‡πÅ‡∏Æ‡∏£‡πå‡∏£‡∏µ‡πà ‡∏û‡∏≠‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå'?",
            "options": ["J.K. Rowling", "Stephen King", "George R.R. Martin", "J.R.R. Tolkien"],
            "correct": 0,
            "explanation": "J.K. Rowling ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡πÅ‡∏Æ‡∏£‡πå‡∏£‡∏µ‡πà ‡∏û‡∏≠‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå"
        },
        {
            "id": 4,
            "question": "‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞‡∏Ñ‡∏∑‡∏≠?",
            "options": ["‡∏î‡∏≤‡∏ß‡∏®‡∏∏‡∏Å‡∏£‡πå", "‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå", "‡∏î‡∏≤‡∏ß‡∏¢‡∏π‡πÄ‡∏£‡∏ô‡∏±‡∏™"],
            "correct": 1,
            "explanation": "‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞"
        },
        {
            "id": 5,
            "question": "‡∏†‡∏≤‡∏©‡∏≤‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏î‡πâ‡∏≤‡∏ô Front-end?",
            "options": ["Python", "JavaScript", "Java", "C++"],
            "correct": 1,
            "explanation": "JavaScript ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏î‡πâ‡∏≤‡∏ô Front-end"
        },
        {
            "id": 6,
            "question": "‡∏ó‡∏ß‡∏µ‡∏õ‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?",
            "options": ["‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢", "‡∏¢‡∏∏‡πÇ‡∏£‡∏õ", "‡πÅ‡∏≠‡∏ü‡∏£‡∏¥‡∏Å‡∏≤", "‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÉ‡∏ï‡πâ"],
            "correct": 2,
            "explanation": "‡∏ó‡∏ß‡∏µ‡∏õ‡πÅ‡∏≠‡∏ü‡∏£‡∏¥‡∏Å‡∏≤‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏£‡∏ß‡∏° 54 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®"
        },
        {
            "id": 7,
            "question": "‡πÉ‡∏ô‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå œÄ (pi) ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î?",
            "options": ["3.14", "2.71", "1.41", "4.13"],
            "correct": 0,
            "explanation": "œÄ (pi) ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 3.14159..."
        },
        {
            "id": 8,
            "question": "‡∏™‡∏µ‡πÉ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ú‡∏™‡∏°‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á?",
            "options": ["‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß", "‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á", "‡∏™‡∏µ‡∏™‡πâ‡∏°", "‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π"],
            "correct": 2,
            "explanation": "‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ú‡∏™‡∏°‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á"
        },
        {
            "id": 9,
            "question": "‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å?",
            "options": ["‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢", "‡∏à‡∏µ‡∏ô", "‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤", "‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢"],
            "correct": 0,
            "explanation": "‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô"
        },
        {
            "id": 10,
            "question": "‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πâ‡∏ô‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏†‡∏≤‡∏û?",
            "options": ["Isaac Newton", "Albert Einstein", "Stephen Hawking", "Nikola Tesla"],
            "correct": 1,
            "explanation": "Albert Einstein ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πâ‡∏ô‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏†‡∏≤‡∏û"
        }
    ]
};

// ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏¥‡∏ã
let currentQuestion = 0;
let score = 0;
let selectedAnswer = null;
let isAnswered = false;

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ñ‡∏ß‡∏¥‡∏ã
function startQuiz() {
    document.getElementById('startScreen').classList.add('hidden');
    document.getElementById('quizScreen').classList.remove('hidden');
    // Show nurse and clear speech bubble
    const nurseContainer = document.getElementById('nurseFeedbackContainer');
    const speechBubble = document.getElementById('speechBubble');
    if (nurseContainer) nurseContainer.style.display = '';
    if (speechBubble) speechBubble.textContent = '';
    showQuestion();
}


// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á modal ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ top-level)
function showOptionDetailModal(question, optionIndex) {
    // Remove existing modal if any
    setTimeout(() => {
        const oldModal = document.getElementById('optionDetailModal');
        if (oldModal) oldModal.remove();
        // Get detail text
        const detail = (question.details && question.details[optionIndex]) ? question.details[optionIndex] : '';
        // Create modal
        const modal = document.createElement('div');
        modal.id = 'optionDetailModal';
        modal.className = 'option-detail-modal';
        modal.innerHTML = `
            <div class="option-detail-modal-content">
                <button class="option-detail-modal-close" id="optionDetailModalClose">&times;</button>
                <div class="option-detail-modal-body">${detail || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°'}</div>
            </div>
        `;
        document.body.appendChild(modal);
        // Close modal on button click or background click
        document.getElementById('optionDetailModalClose').onclick = () => modal.remove();
        modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
    }, 0);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
function showQuestion() {
    const question = quizData.questions[currentQuestion];

    document.getElementById('questionNumber').textContent = currentQuestion + 1;
    document.getElementById('totalQuestions').textContent = quizData.questions.length;
    document.getElementById('questionText').textContent = question.question;

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï progress bar
    const progress = ((currentQuestion + 1) / quizData.questions.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    const optionsContainer = document.getElementById('optionsContainer');
    optionsContainer.innerHTML = '';

    question.options.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'option';
        // Add text span
        const textSpan = document.createElement('span');
        textSpan.textContent = option;
        optionElement.appendChild(textSpan);
        optionsContainer.appendChild(optionElement);
    });
    // ‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏° info ‡πÄ‡∏â‡∏•‡∏¢‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà
    const oldExplainBtn = document.getElementById('optionExplainBtn');
    if (oldExplainBtn) oldExplainBtn.remove();

    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
    selectedAnswer = null;
    isAnswered = false;

    document.getElementById('nextButton').disabled = true;
    document.getElementById('feedback').classList.remove('show');
    // ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ speech bubble ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠ ‡πÅ‡∏ï‡πà nurse ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏™‡∏°‡∏≠
    const nurseContainer = document.getElementById('nurseFeedbackContainer');
    if (nurseContainer) nurseContainer.classList.remove('show-bubble');

    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°
    const nextButton = document.getElementById('nextButton');
    if (currentQuestion === quizData.questions.length - 1) {
        nextButton.textContent = '‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå';
    } else {
        nextButton.textContent = '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ';
    }

    // ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
    const backButton = document.getElementById('backButton');
    if (currentQuestion === 0) {
        backButton.style.display = 'none';
    } else {
        backButton.style.display = 'block';
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å setupConfirmButton ‡∏´‡∏•‡∏±‡∏á render ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    setupConfirmButton(function (selectedOptionDiv) {
        const options = Array.from(optionsContainer.children);
        const answerIndex = options.indexOf(selectedOptionDiv);
        confirmAnswer(answerIndex);
    });
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
function confirmAnswer(answerIndex) {
    if (isAnswered) return;

    const options = document.querySelectorAll('.option');
    const question = quizData.questions[currentQuestion];

    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
    selectedAnswer = answerIndex;
    options[answerIndex].classList.add('selected');

    setTimeout(() => {
        isAnswered = true;

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        options[question.correct].classList.add('correct');

        // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å" ‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à (modal)
        if (question.details) {
            // ‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            let oldBtn = document.getElementById('showAllOptionDetailsBtn');
            if (oldBtn) oldBtn.remove();
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
            let btn = document.createElement('button');
            btn.id = 'showAllOptionDetailsBtn';
            btn.className = 'quiz-button';
            btn.style.position = 'absolute';
            btn.style.top = '18px';
            btn.style.right = '18px';
            btn.style.zIndex = '10';
            btn.style.width = 'auto';
            btn.style.padding = '8px 22px';
            btn.style.fontSize = '1em';
            btn.style.background = '#fff';
            btn.style.color = '#1976D2';
            btn.style.border = '2px solid #2196F3';
            btn.style.borderRadius = '18px';
            btn.style.boxShadow = '0 2px 8px rgba(33, 150, 243, 0.08)';
            btn.innerHTML = '‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å';
            btn.onclick = function (e) {
                e.stopPropagation();
                showAllOptionDetailsModal(question, answerIndex);
            };
            // ‡∏´‡∏≤ quiz-container ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏∞‡∏õ‡∏∏‡πà‡∏°
            const quizContainer = document.querySelector('.quiz-container');
            if (quizContainer) quizContainer.appendChild(btn);
        }

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô modal ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (move to top-level)
function showAllOptionDetailsModal(question, answerIndex) {
    // Remove existing modal if any
    const oldModal = document.getElementById('allOptionDetailsModal');
    if (oldModal) oldModal.remove();
    // Create modal
    let modal = document.createElement('div');
    modal.id = 'allOptionDetailsModal';
    modal.className = 'option-detail-modal';
    let content = document.createElement('div');
    content.className = 'option-detail-modal-content';
    content.style.minWidth = '320px';
    content.style.maxWidth = '98vw';
    content.innerHTML = `<button class="option-detail-modal-close" id="allOptionDetailsModalClose">&times;</button><div class="option-detail-modal-body"><b>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</b><br></div>`;
    let body = content.querySelector('.option-detail-modal-body');
    question.options.forEach((opt, idx) => {
        let isCorrect = (idx === question.correct);
        let icon = isCorrect ? '‚úîÔ∏è' : '‚ùå';
        let color = isCorrect ? '#388e3c' : '#d32f2f';
        let fontWeight = 'bold';
        let detail = (question.details && question.details[idx]) ? question.details[idx] : '-';
        body.innerHTML += `<div style="margin:10px 0 0 0;padding:7px 0 7px 0;display:flex;align-items:flex-start;gap:8px;">
            <span style="font-size:1.2em;color:${color};font-weight:${fontWeight};min-width:2em;">${icon}</span>
            <span style="color:${color};font-weight:${fontWeight};">${opt}</span>
        </div>
        <div style="margin-left:2.5em;color:#1976D2;white-space:pre-line;">${detail}</div>`;
    });
    modal.appendChild(content);
    document.body.appendChild(modal);
    document.getElementById('allOptionDetailsModalClose').onclick = () => modal.remove();
    modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
}

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏¥‡∏î ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î
        if (selectedAnswer !== question.correct) {
            options[selectedAnswer].classList.add('incorrect');
            showFeedback('incorrect', '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ' + question.options[question.correct]);
        } else {
            score++;
            showFeedback('correct', '‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ' + question.explanation);
            showCelebrateEffect();
        }

        // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏â‡∏•‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å
        function showCelebrateEffect() {
            const container = document.createElement('div');
            container.className = 'celebrate-effect';
            for (let i = 0; i < 36; i++) {
                const confetti = document.createElement('div');
                const size = Math.random() * 14 + 10;
                confetti.style.position = 'absolute';
                confetti.style.left = (Math.random() * 100) + 'vw';
                confetti.style.top = (Math.random() * 40 + 30) + 'vh';
                confetti.style.width = size + 'px';
                confetti.style.height = size + 'px';
                confetti.style.borderRadius = '50%';
                confetti.style.background = randomConfettiColor();
                confetti.style.opacity = '0.85';
                confetti.style.animation = `popConfetti 2.5s cubic-bezier(.62,.01,.48,1.01) forwards`;
                confetti.style.animationDelay = (Math.random() * 0.7) + 's';
                container.appendChild(confetti);
            }
            document.body.appendChild(container);
            setTimeout(() => container.remove(), 3000);
        }

        function randomConfettiColor() {
            const colors = ['#FFD700', '#4CAF50', '#2196F3', '#FF9800', '#E91E63', '#00BCD4', '#FFEB3B', '#8BC34A'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
        document.getElementById('nextButton').disabled = false;

        // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        options.forEach(option => {
            option.style.pointerEvents = 'none';
        });

        // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
        document.getElementById('confirmButton').style.display = 'none';
    }, 300);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô setupConfirmButton ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
function setupConfirmButton(onConfirm) {
    const optionsContainer = document.getElementById('optionsContainer');
    const confirmButton = document.getElementById('confirmButton');
    confirmButton.style.display = 'none';
    confirmButton.disabled = false;
    let selectedOption = null;
    let confirmCallback = onConfirm;
    Array.from(optionsContainer.children).forEach(option => {
        option.onclick = function () {
            Array.from(optionsContainer.children).forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
            selectedOption = this;
            confirmButton.style.display = '';
        };
    });
    confirmButton.onclick = function () {
        if (selectedOption && confirmCallback) {
            confirmButton.disabled = true;
            confirmCallback(selectedOption);
        }
    };
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
function selectAnswer(answerIndex) {
    if (isAnswered) return;

    const options = document.querySelectorAll('.option');
    const question = quizData.questions[currentQuestion];

    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
    selectedAnswer = answerIndex;
    options[answerIndex].classList.add('selected');

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
    setTimeout(() => {
        isAnswered = true;

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        options[question.correct].classList.add('correct');

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏¥‡∏î ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î
        if (selectedAnswer !== question.correct) {
            options[selectedAnswer].classList.add('incorrect');
            showFeedback('incorrect', '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ' + question.options[question.correct]);
        } else {
            score++;
            showFeedback('correct', '‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ' + question.explanation);
        }

        // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
        document.getElementById('nextButton').disabled = false;

        // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        options.forEach(option => {
            option.style.pointerEvents = 'none';
        });

    }, 300);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
function showFeedback(type, message) {
    const feedback = document.getElementById('feedback');
    feedback.textContent = message;
    feedback.className = `feedback ${type} show`;

    // Nurse feedback logic with typewriter effect
    const nurseContainer = document.getElementById('nurseFeedbackContainer');
    const speechBubble = document.getElementById('speechBubble') || document.getElementById('nurseSpeechBubble');
    if (nurseContainer && speechBubble) {
        let nurseMsg = '';
        if (type === 'correct') {
            const praise = [
                '‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å‡∏Ñ‡πà‡∏∞!',
                '‡πÄ‡∏Å‡πà‡∏á‡∏™‡∏∏‡∏î‡πÜ!',
                '‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞!',
                '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡πÄ‡∏•‡∏¢!',
                '‡∏ô‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡∏°‡∏≤‡∏Å!'
            ];
            nurseMsg = praise[Math.floor(Math.random() * praise.length)] + ' ' + (message || '');
        } else {
            const encourage = [
                '‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ!',
                '‡∏™‡∏π‡πâ‡πÜ ‡∏Ñ‡πà‡∏∞!',
                '‡∏≠‡∏¢‡πà‡∏≤‡∏ó‡πâ‡∏≠‡∏Ñ‡πà‡∏∞ ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ!',
                '‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏π‡∏ô‡∏∞‡∏Ñ‡∏∞!',
                '‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏Å‡πá‡πÄ‡∏Å‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏∞!'
            ];
            nurseMsg = encourage[Math.floor(Math.random() * encourage.length)] + ' ' + (message || '');
        }
        nurseContainer.style.display = 'flex';
        // Typewriter effect
        let i = 0;
        speechBubble.textContent = '';
        function typeWriter() {
            if (i < nurseMsg.length) {
                speechBubble.textContent += nurseMsg.charAt(i);
                i++;
                setTimeout(typeWriter, 18 + Math.random() * 32); // speed: 18-50ms/char
            }
        }
        setTimeout(typeWriter, 250); // delay before start typing
    }
}
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
function previousQuestion() {
    if (currentQuestion > 0) {
        currentQuestion--;
        showQuestion();
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
function nextQuestion() {
    if (currentQuestion < quizData.questions.length - 1) {
        currentQuestion++;
        showQuestion();
    } else {
        showResult();
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
function showResult() {
    document.getElementById('quizScreen').classList.add('hidden');
    document.getElementById('resultScreen').classList.remove('hidden');

    const percentage = Math.round((score / quizData.questions.length) * 100);

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
    document.getElementById('scorePercentage').textContent = percentage + '%';
    document.getElementById('correctAnswers').textContent = score;
    document.getElementById('totalQuestionsFinal').textContent = quizData.questions.length;

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    let message = '';
    if (percentage >= 80) {
        message = 'üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!';
    } else if (percentage >= 60) {
        message = 'üëç ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ!';
    } else if (percentage >= 40) {
        message = 'üòä ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞!';
    } else {
        message = 'üí™ ‡∏≠‡∏¢‡πà‡∏≤‡∏ó‡πâ‡∏≠! ‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°!';
    }

    document.getElementById('resultMessage').textContent = message;

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
    const scoreCircle = document.querySelector('.score-circle');
    const degrees = (percentage / 100) * 360;
    scoreCircle.style.background = `conic-gradient(#667eea 0deg, #764ba2 ${degrees}deg, #e0e0e0 ${degrees}deg)`;
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏ß‡∏¥‡∏ã
function resetQuiz() {
    currentQuestion = 0;
    score = 0;
    selectedAnswer = null;
    isAnswered = false;

    document.getElementById('resultScreen').classList.add('hidden');
    document.getElementById('startScreen').classList.remove('hidden');
    // ‡∏ã‡πà‡∏≠‡∏ô nurse feedback ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
    const nurseContainer = document.getElementById('nurseFeedbackContainer');
    if (nurseContainer) nurseContainer.style.display = 'none';
}

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏≠‡∏û
window.onload = function () {
    console.log('Quiz App Loaded Successfully!');
    console.log('Total Questions:', quizData.questions.length);
};

